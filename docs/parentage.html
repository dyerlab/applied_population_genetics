<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>15&nbsp; Parentage Analyses – Applied Population Genetics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./part_subdivided_populations.html" rel="next">
<link href="./pedigrees.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1b3e43c72e8be34557c75123b0b69e0d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6d16390398e4ca57b3acf2d898365235.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="media/style.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./parentage.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Parentage Analyses</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Population Genetics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/dyerlab/AMG" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applied Population Genetics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_ecosystem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The R Ecosystem</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datatypes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Types</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_containers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Containers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Programming</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reproducable_research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducable Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_single_population.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(PART) Single Population</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hardy_weinberg_equilibrium.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hardy-Weinberg Equilibrium</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./genetic_drift.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Genetic Drift</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./effective_population_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Effective Population Size</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mutation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mutation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_nonrandom_mating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(PART) Nonrandom Rating</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./selfing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Selfing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mixed_mating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Mixed Mating Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wahlund_effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Wahlund Effects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_parent_offspring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(PART) Parent Offspring Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pedigrees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Pedigrees</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parentage.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Parentage Analyses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_subdivided_populations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(PART) Subdivided Populations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mapping_populations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Mapping Populations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./population_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Population Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./genetic_diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Genetic Diversity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rarefaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Rarefaction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./genetic_distance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Genetic Distances</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./genetic_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Genetic Structure</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./population_assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Population Assignment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./admixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Admixture</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(PART) Statistical Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Ordination of Genetic Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./distance_matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Distance Matrices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Linear Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./distance_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Distance Networks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./population_graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Population Graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interactive_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Interactive Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_spatial_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(PART) Spatial Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vector_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Vector Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./raster_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Raster Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./projections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Map Projections</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ecological_distance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Ecological Distance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./niche_modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Niche Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eigenmaps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Eigenvector Maps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(PART) Selection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Classical Selection Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_backmatter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(PART) Backmatter</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Included Data Sets</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about_the_author.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the Author</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#paternity-vs.-maternity" id="toc-paternity-vs.-maternity" class="nav-link active" data-scroll-target="#paternity-vs.-maternity"><span class="header-section-number">15.1</span> Paternity vs.&nbsp;Maternity</a></li>
  <li><a href="#probability-of-exclusion" id="toc-probability-of-exclusion" class="nav-link" data-scroll-target="#probability-of-exclusion"><span class="header-section-number">15.2</span> Probability of Exclusion</a></li>
  <li><a href="#paternity-exclusion" id="toc-paternity-exclusion" class="nav-link" data-scroll-target="#paternity-exclusion"><span class="header-section-number">15.3</span> Paternity Exclusion</a></li>
  <li><a href="#fractional-paternity" id="toc-fractional-paternity" class="nav-link" data-scroll-target="#fractional-paternity"><span class="header-section-number">15.4</span> Fractional Paternity</a></li>
  <li><a href="#dispersal-kernels" id="toc-dispersal-kernels" class="nav-link" data-scroll-target="#dispersal-kernels"><span class="header-section-number">15.5</span> Dispersal Kernels</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Parentage Analyses</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="chapter_image">
<img src="chapter_images/ch_butterfly.jpg">
</div>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gstudio</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The analysis of parental and offspring data</p>
<ol type="1">
<li>Parentage-type analyses.<br>
</li>
<li>Analyses based upon multiple paternity</li>
</ol>
<p>Parentage analyses are used in a broad range of studies:</p>
<ul>
<li>Identical vs fraternal twins<br>
</li>
<li>Agricultural crop line differentiation<br>
</li>
<li>Differentiate between livestock/dog/cat breeds<br>
</li>
<li>Pathogenic strain identification (e.g., Hep-C strains <em>a-e</em>)<br>
</li>
<li>Assigning parentage to individuals<br>
</li>
<li>Assigning individuals to populations<br>
</li>
<li>Identifying the source of unknown tissues (e.g., gettin’ perps)</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"media/paternity.png"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="media/paternity.png" class="img-fluid figure-img" width="390"></p>
</figure>
</div>
</div>
</div>
<p>A statistical approach for identifying the parent(s) of a particular individual. This requires:</p>
<ol type="1">
<li>A set of genetic markers that are bi-parentally inherited</li>
<li>Variation in these markers</li>
<li>Some assumptions about the <em>prior</em> probability of the union of parents.</li>
</ol>
<section id="paternity-vs.-maternity" class="level2" data-number="15.1"><h2 data-number="15.1" class="anchored" data-anchor-id="paternity-vs.-maternity">
<span class="header-section-number">15.1</span> Paternity vs.&nbsp;Maternity</h2>
<p>For single parent parentage analysis, it is either paternity or maternity that is being established. Here we assume that the other parent is definitely the biological parent of the individual (e.g., <span class="math inline">\(P(prior)=1\)</span>). This can be because:</p>
<ol type="1">
<li>The offspring was collected from the identified parent</li>
<li>There is other evidence that points to the identified parent being the biological one.</li>
</ol>
<p>The goal then is to determine who the unidentified parent is with some level of statistical probability.</p>
<p>Terms Used in Parentage</p>
<p>The following terms are commonly used in parentage analyses:</p>
<p><strong>Extra-Pair Paternity</strong> - Fertilization resulting from copulation outside a recognized pair bond.</p>
<p><strong>Multiple Paternity</strong> - Offspring produced from mating events with different sets of individuals.</p>
<p><strong>Paternity/Maternity Exclusion</strong> - Excluding an individual based upon an in-congruence in observed genetic data.</p>
</section><section id="probability-of-exclusion" class="level2" data-number="15.2"><h2 data-number="15.2" class="anchored" data-anchor-id="probability-of-exclusion">
<span class="header-section-number">15.2</span> Probability of Exclusion</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 32%">
<col style="width: 25%">
<col style="width: 17%">
</colgroup>
<thead><tr class="header">
<th>Mother</th>
<th>Offspring</th>
<th>Excluded Dads</th>
<th>Probability</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(A_1A_1\;(p^2_1)\)</span></td>
<td><span class="math inline">\(A_1A_1\;(p_1)\)</span></td>
<td><span class="math inline">\(A_2A_2\;(p_2^2)\)</span></td>
<td><span class="math inline">\(p_1^3p_2^2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_1A_1\;(p^2_1)\)</span></td>
<td><span class="math inline">\(A_1A_2\;(p_2)\)</span></td>
<td><span class="math inline">\(A_1A_1\;(p_1^2)\)</span></td>
<td><span class="math inline">\(p_1^4p_2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A_1A_1\;(p^2_1)\)</span></td>
<td><span class="math inline">\(A_2A_2\;(0)\)</span></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_1A_2\;(2p_1p_2)\)</span></td>
<td><span class="math inline">\(A_1A_1\;(\frac{p_1}{2})\)</span></td>
<td><span class="math inline">\(A_2A_2\;(p_2^2)\)</span></td>
<td><span class="math inline">\(p_1^2p_2^3\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A_1A_2\;(2p_1p_2)\)</span></td>
<td><span class="math inline">\(A_1A_2\;(\frac{1}{2})\)</span></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_1A_2\;(2p_1p_2)\)</span></td>
<td><span class="math inline">\(A_2A_2\;(\frac{p_2}{2})\)</span></td>
<td><span class="math inline">\(A_1A_1\;(p_1^2)\)</span></td>
<td><span class="math inline">\(p_1^3p_2^2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A_2A_2\;(p^2_2)\)</span></td>
<td><span class="math inline">\(A_1A_1\;(0)\)</span></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_2A_2\;(p^2_2)\)</span></td>
<td><span class="math inline">\(A_1A_2\;(p_1)\)</span></td>
<td><span class="math inline">\(A_2A_2\;(p_2^2)\)</span></td>
<td><span class="math inline">\(p_1p_2^4\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A_2A_2\;(p^2_2)\)</span></td>
<td><span class="math inline">\(A_2A_2\;(p_2)\)</span></td>
<td><span class="math inline">\(A_1A_1\;(p_1^2)\)</span></td>
<td><span class="math inline">\(p_1^2p_2^3\)</span></td>
</tr>
</tbody>
</table>
<p>Probability of Exclusion</p>
<p>[ P_{exc} = p_1<sup>3p_2</sup>2 + p_1^4p_2 +p_1<sup>2p_2</sup>3 +p_1<sup>3p_2</sup>2 +p_1p_2^4 +p_1<sup>2p_2</sup>3 \ ]</p>
<p>which when simplified down a bit becomes</p>
<p>[ P_{exc} = p_1p_2(1-p_1p_2) ]</p>
<p>Single Locus Paternity Exclusion</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.02</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="va">p</span></span>
<span><span class="va">Pexcl</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">*</span><span class="va">q</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">*</span><span class="va">q</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pexcl</span> <span class="op">~</span> <span class="va">p</span>, xlab<span class="op">=</span><span class="st">"Allele frequency, p"</span>, ylab<span class="op">=</span><span class="st">"Paternity Exclusion Probability"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="parentage_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Multilocus Exclusion</p>
<p>Exclusion probabilities are multiplicative properties.</p>
<p>[ P_{excl} = 1 - <em>{i=1}^(1-P</em>{excl,;i}) ]</p>
<p>Example</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">)</span>, <span class="fl">5</span> <span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1875 0.1875 0.1875 0.1875 0.1875</code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ptot</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span><span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">ptot</span> <span class="op">&lt;-</span> <span class="va">ptot</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fl">1</span><span class="op">-</span><span class="va">ptot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6459074</code></pre>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 25%">
<col style="width: 27%">
<col style="width: 30%">
</colgroup>
<thead><tr class="header">
<th>Mother</th>
<th>Offspring</th>
<th>Excluded Father <span class="math inline">\(A_xA_y\)</span>
</th>
<th>Probability of Exclusion</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(A_iA_i\;(p_i^2)\)</span></td>
<td><span class="math inline">\(A_iA_i\;(p_i)\)</span></td>
<td><span class="math inline">\(x,y\ne i\;\; (1-p_i)^2\)</span></td>
<td><span class="math inline">\(p_i^3(1-p_i)^2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_iA_i\;(p_i^2)\)</span></td>
<td><span class="math inline">\(A_iA_j\;(p_j)\)</span></td>
<td><span class="math inline">\(x,y\ne j\;\; (1-p_j)^2\)</span></td>
<td><span class="math inline">\(p_i^2p_j(1-p_i)^2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A_iA_j\;(2p_ip_j)\)</span></td>
<td><span class="math inline">\(A_iA_i\;(\frac{p_i}{2})\)</span></td>
<td><span class="math inline">\(x,y \ne i\;\; (1-p_i)^2\)</span></td>
<td><span class="math inline">\(p_i^2p_j(1-p_i)^2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_iA_j\;(2p_ip_j)\)</span></td>
<td><span class="math inline">\(A_iA_j\;(\frac{p_i+p_j}{2})\)</span></td>
<td><span class="math inline">\(x,y \ne i,j\;\; (1-p_i-p_j)^2\)</span></td>
<td><span class="math inline">\(p_ip_j(p_i+p_j)(1-p_i-p_j)^2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A_iA_j\;(2p_ip_j)\)</span></td>
<td><span class="math inline">\(A_iA_k\;(\frac{p_k}{2})\)</span></td>
<td><span class="math inline">\(x,y \ne k\;\; (1-p_k)^2\)</span></td>
<td><span class="math inline">\(p_ip_jp_k(1-p_k)^2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_iA_j\;(2p_ip_j)\)</span></td>
<td><span class="math inline">\(A_jA_k\;(\frac{p_k}{2})\)</span></td>
<td><span class="math inline">\(x,y \ne k\;\; (1-p_k)^2\)</span></td>
<td><span class="math inline">\(p_ip_jp_k(1-p_k)^2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A_iA_j\;(2p_ip_j)\)</span></td>
<td><span class="math inline">\(A_jA_j\;(\frac{p_j}{2})\)</span></td>
<td><span class="math inline">\(x,y \ne j\;\; (1-p_j)^2\)</span></td>
<td><span class="math inline">\(p_ip_j^2(1-p_j)^2\)</span></td>
</tr>
</tbody>
</table></section><section id="paternity-exclusion" class="level2" data-number="15.3"><h2 data-number="15.3" class="anchored" data-anchor-id="paternity-exclusion">
<span class="header-section-number">15.3</span> Paternity Exclusion</h2>
<p>Likelihood Ratios</p>
<p>A likelihood ratio is given by:</p>
<p>[ LR = ]</p>
<p>where the <span class="math inline">\(H_X\)</span> values are the hypotheses probabilities.</p>
<p>Nomenclature For Parentage</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Individual</th>
<th>Identifier</th>
<th>Genotype</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Female Parent</td>
<td><span class="math inline">\(FP_i\)</span></td>
<td><span class="math inline">\(\alpha_i\)</span></td>
</tr>
<tr class="even">
<td>Putative Male Parent</td>
<td><span class="math inline">\(MP_j\)</span></td>
<td><span class="math inline">\(\beta_j\)</span></td>
</tr>
<tr class="odd">
<td>Offspring</td>
<td><span class="math inline">\(O_k\)</span></td>
<td><span class="math inline">\(\gamma_k\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\;\)</span></p>
<p><strong>Paternal Probability</strong> The posterior odds of paternity versus non-paternity given the totality of genetic information.</p>
<p>Likelihood Ratios | Genetic Equivalences</p>
<p>The likelihood of one hypothesis, <span class="math inline">\(H_1\)</span> relative to another <span class="math inline">\(H_2\)</span> is:</p>
<p>[ L(H_1,H_2|D) = ]</p>
<p>where</p>
<p>[ P(D|H) = T(| , )P()P() ]</p>
<p>Assuming <span class="math inline">\(H_1:\)</span> states that <span class="math inline">\(\beta\)</span> is the real father of <span class="math inline">\(\gamma\)</span> on <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(H_2:\)</span> states that he is just a random individual in the population is:</p>
<p>[ L(H_1,H_2|,,) = <br>
]</p>
<p>which can be simplified to:</p>
<p>[ _j = \ = \ = ]</p>
<p>where <span class="math inline">\(T(X|Y)\)</span> is the Mendelian transition probability of offspring <span class="math inline">\(X\)</span> given parent <span class="math inline">\(Y\)</span>.</p>
<p>Assumptions in Model of Paternity Likelihood</p>
<p>The basic paternity exclusion model assumes:</p>
<ol type="1">
<li>Completely random mating (can be modified by changin <em>priors</em>)</li>
<li>Independent assortment of alleles</li>
</ol>
<p>Likelihood Example</p>
<p>Consider the maternal individual whose genotypes are: [ FP = {AA,;Bb,;CC,;Dd} ]</p>
<p>Whose <span class="math inline">\(i^{th}\)</span> offspring has the genotypes:</p>
<p>[ O_i = {AA,;BB,;Cc,;dd} ]</p>
<p>Likelihood Example | <span class="math inline">\(T(O|FP)\)</span></p>
<p>The transition probability, <span class="math inline">\(T(O|FP)\)</span>, is then:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Individual</th>
<th>Locus1</th>
<th>Locus2</th>
<th>Locus3</th>
<th>Locus4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(FP\)</span></td>
<td><span class="math inline">\(AA\)</span></td>
<td><span class="math inline">\(Bb\)</span></td>
<td><span class="math inline">\(CC\)</span></td>
<td><span class="math inline">\(Dd\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(O_i\)</span></td>
<td><span class="math inline">\(AA\)</span></td>
<td><span class="math inline">\(BB\)</span></td>
<td><span class="math inline">\(Cc\)</span></td>
<td><span class="math inline">\(dd\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(T(O|FP) = 1*0.5*1*0.5 = 0.25\)</span></p>
<p>Likelihood Example | Putative Male Parents</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Individual</th>
<th>Locus1</th>
<th>Locus2</th>
<th>Locus3</th>
<th>Locus4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(MP_1\)</span></td>
<td><span class="math inline">\(Aa\)</span></td>
<td><span class="math inline">\(BB\)</span></td>
<td><span class="math inline">\(cc\)</span></td>
<td><span class="math inline">\(Dd\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(MP_2\)</span></td>
<td><span class="math inline">\(AA\)</span></td>
<td><span class="math inline">\(BB\)</span></td>
<td><span class="math inline">\(Cc\)</span></td>
<td><span class="math inline">\(dd\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\;\)</span></p>
<p>Which one of the potential fathers is the <font class="alert">most likely</font> parent?</p>
<p>Likelihood Example | First Putative Father</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Individual</th>
<th>Locus1</th>
<th>Locus2</th>
<th>Locus3</th>
<th>Locus4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(FP\)</span></td>
<td><span class="math inline">\(AA\)</span></td>
<td><span class="math inline">\(Bb\)</span></td>
<td><span class="math inline">\(CC\)</span></td>
<td><span class="math inline">\(Dd\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(MP_1\)</span></td>
<td><span class="math inline">\(Aa\)</span></td>
<td><span class="math inline">\(BB\)</span></td>
<td><span class="math inline">\(cc\)</span></td>
<td><span class="math inline">\(Dd\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(O_i\)</span></td>
<td><span class="math inline">\(AA\)</span></td>
<td><span class="math inline">\(BB\)</span></td>
<td><span class="math inline">\(Cc\)</span></td>
<td><span class="math inline">\(dd\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(T(O|FP,MP)\)</span></td>
<td>0.5</td>
<td>0.5</td>
<td>1.0</td>
<td>0.25</td>
</tr>
</tbody>
</table>
<p>[ T(O_1|FP,MP_1) = 0.5 * 0.5 * 1.0 * 0.25 = 0.0625 ]</p>
<p>And</p>
<p>[ _1 = = = 0.25 ]</p>
<p>Likelihood Example | Second Putative Father</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Individual</th>
<th>Locus1</th>
<th>Locus2</th>
<th>Locus3</th>
<th>Locus4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(FP\)</span></td>
<td><span class="math inline">\(AA\)</span></td>
<td><span class="math inline">\(Bb\)</span></td>
<td><span class="math inline">\(CC\)</span></td>
<td><span class="math inline">\(Dd\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(MP_2\)</span></td>
<td><span class="math inline">\(AA\)</span></td>
<td><span class="math inline">\(BB\)</span></td>
<td><span class="math inline">\(Cc\)</span></td>
<td><span class="math inline">\(dd\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(O_i\)</span></td>
<td><span class="math inline">\(AA\)</span></td>
<td><span class="math inline">\(BB\)</span></td>
<td><span class="math inline">\(Cc\)</span></td>
<td><span class="math inline">\(dd\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(T(O|FP,MP)\)</span></td>
<td>1.0</td>
<td>0.5</td>
<td>0.5</td>
<td>0.5</td>
</tr>
</tbody>
</table>
<p>[ T(O_1|FP,MP_2) = 1.0 * 0.5 * 0.5 * 0.5 = 0.125 ]</p>
<p>And</p>
<p>[ _2 = = = 0.5 ]</p>
<p>Likelihood Example | Interpretation of Results {.build}</p>
<p>Most likely parent is <span class="math inline">\(MP_2\)</span> because <span class="math inline">\(\lambda_2 = 0.5 &gt; \lambda_1 = 0.25\)</span>.</p>
<p><span class="math inline">\(\;\)</span></p>
<p>Does this mean that <span class="math inline">\(MP_2\)</span> is the <font class="alert">real</font> parent?</p>
<p>Likelihood Example | In Class Exercise - Whose the daddies?</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Individual</th>
<th>Locus 1</th>
<th>Locus 2</th>
<th>Locus 3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Mother</td>
<td><span class="math inline">\(A_1A_1\)</span></td>
<td><span class="math inline">\(B_1B_3\)</span></td>
<td><span class="math inline">\(C_1C_1\)</span></td>
</tr>
<tr class="even">
<td>Offspring 1</td>
<td><span class="math inline">\(A_1A_2\)</span></td>
<td><span class="math inline">\(B_1B_3\)</span></td>
<td><span class="math inline">\(C_1C_2\)</span></td>
</tr>
<tr class="odd">
<td>Offspring 2</td>
<td><span class="math inline">\(A_1A_1\)</span></td>
<td><span class="math inline">\(B_3B_3\)</span></td>
<td><span class="math inline">\(C_1C_1\)</span></td>
</tr>
<tr class="even">
<td>Offspring 3</td>
<td><span class="math inline">\(A_1A_1\)</span></td>
<td><span class="math inline">\(B_1B_1\)</span></td>
<td><span class="math inline">\(C_1C_1\)</span></td>
</tr>
<tr class="odd">
<td>Dad 1</td>
<td><span class="math inline">\(A_1A_2\)</span></td>
<td><span class="math inline">\(B_2B_3\)</span></td>
<td><span class="math inline">\(C_1C_1\)</span></td>
</tr>
<tr class="even">
<td>Dad 2</td>
<td><span class="math inline">\(A_2A_2\)</span></td>
<td><span class="math inline">\(B_1B_1\)</span></td>
<td><span class="math inline">\(C_1C_2\)</span></td>
</tr>
<tr class="odd">
<td>Dad 3</td>
<td><span class="math inline">\(A_1A_1\)</span></td>
<td><span class="math inline">\(B_2B_3\)</span></td>
<td><span class="math inline">\(C_1C_2\)</span></td>
</tr>
<tr class="even">
<td>Dad 4</td>
<td><span class="math inline">\(A_1A_1\)</span></td>
<td><span class="math inline">\(B_1B_1\)</span></td>
<td><span class="math inline">\(C_2C_2\)</span></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gstudio</span><span class="op">)</span></span>
<span><span class="va">loci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Locus-A"</span>,<span class="st">"Locus-B"</span>,<span class="st">"Locus-C"</span>,<span class="st">"Locus-D"</span><span class="op">)</span></span>
<span><span class="va">freqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Locus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">loci</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, </span>
<span>                    Allele <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, </span>
<span>                    Frequency <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">freqs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Locus Allele Frequency
1  Locus-A      A      0.25
2  Locus-A      B      0.25
3  Locus-A      C      0.25
4  Locus-A      D      0.25
5  Locus-B      A      0.25
6  Locus-B      B      0.25
7  Locus-B      C      0.25
8  Locus-B      D      0.25
9  Locus-C      A      0.25
10 Locus-C      B      0.25
11 Locus-C      C      0.25
12 Locus-C      D      0.25
13 Locus-D      A      0.25
14 Locus-D      B      0.25
15 Locus-D      C      0.25
16 Locus-D      D      0.25</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">adults</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gstudio/man/make_population.html">make_population</a></span><span class="op">(</span> <span class="va">freqs</span>, N<span class="op">=</span><span class="fl">100</span> <span class="op">)</span></span>
<span><span class="va">adults</span><span class="op">$</span><span class="va">OffID</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adults</span> <span class="op">&lt;-</span> <span class="va">adults</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">adults</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID OffID Locus-A Locus-B Locus-C Locus-D
1  1     0     B:D     B:D     B:D     C:D
2  2     0     D:D     B:C     B:B     A:C
3  3     0     A:C     B:D     A:C     A:A
4  4     0     A:D     B:D     D:D     A:B
5  5     0     D:D     B:B     B:B     A:C</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">offs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mom</span> <span class="op">&lt;-</span> <span class="va">adults</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="kw">for</span><span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dad_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span> <span class="fl">1</span>, min<span class="op">=</span><span class="fl">2</span>, max<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="va">dad</span> <span class="op">&lt;-</span> <span class="va">adults</span><span class="op">[</span><span class="va">dad_id</span>,<span class="op">]</span></span>
<span>  <span class="va">off</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gstudio/man/mate.html">mate</a></span><span class="op">(</span> <span class="va">mom</span>, <span class="va">dad</span>, N<span class="op">=</span><span class="fl">1</span> <span class="op">)</span></span>
<span>  <span class="va">offs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span> <span class="va">offs</span>, <span class="va">off</span> <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">offs</span><span class="op">$</span><span class="va">OffID</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span></span>
<span><span class="va">offs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID OffID Locus-A Locus-B Locus-C Locus-D
1  1     1     D:D     B:D     C:D     B:C
2  1     2     B:B     D:D     B:C     B:D
3  1     3     A:D     B:C     B:D     D:D
4  1     4     B:B     B:C     B:B     D:D
5  1     5     D:D     B:D     B:D     B:C</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span> <span class="va">adults</span>, <span class="va">offs</span> <span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">ID</span>,<span class="va">data</span><span class="op">$</span><span class="va">OffID</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ID OffID Locus-A Locus-B Locus-C Locus-D
1   1     0     B:D     B:D     B:D     C:D
2   1     1     D:D     B:D     C:D     B:C
3   1     2     B:B     D:D     B:C     B:D
4   1     3     A:D     B:C     B:D     D:D
5   1     4     B:B     B:C     B:B     D:D
6   1     5     D:D     B:D     B:D     B:C
7   1     6     B:D     C:D     A:B     C:D
8   1     7     D:D     B:D     B:D     C:D
9   1     8     D:D     B:B     B:D     C:C
10  1     9     A:B     B:C     B:D     C:D</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gstudio/man/frequencies.html">frequencies</a></span><span class="op">(</span> <span class="va">data</span><span class="op">[</span> <span class="va">data</span><span class="op">$</span><span class="va">OffID</span><span class="op">==</span><span class="fl">0</span>,<span class="op">]</span> <span class="op">)</span></span>
<span><span class="va">excl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gstudio/man/exclusion_probability.html">exclusion_probability</a></span><span class="op">(</span> <span class="va">f</span> <span class="op">)</span></span>
<span><span class="va">excl</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Locus     Pexcl  PexclMax  Fraction
1 Locus-A 0.5038453 0.5039062 0.9998791
2 Locus-B 0.5038453 0.5039062 0.9998791
3 Locus-C 0.5037248 0.5039062 0.9996400
4 Locus-D 0.5038453 0.5039062 0.9998791</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">excl</span><span class="op">$</span><span class="va">Pexcl</span></span>
<span><span class="va">excl_multilocus</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">-</span><span class="va">p</span> <span class="op">)</span></span>
<span><span class="va">excl_multilocus</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9393859</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">family</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span> <span class="va">data</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gstudio/man/minus_mom.html">minus_mom</a></span><span class="op">(</span> <span class="va">family</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ID OffID Locus-A Locus-B Locus-C Locus-D
2   1     1       D     B:D       C       B
3   1     2       B       D       C       B
4   1     3       A       C     B:D       D
5   1     4       B       C       B       D
6   1     5       D     B:D     B:D       B
7   1     6     B:D       C       A     C:D
8   1     7       D     B:D     B:D     C:D
9   1     8       D       B     B:D       C
10  1     9       A       C     B:D     C:D
11  1    10       A       C       C       A
12  1    11     B:D       B       B       B
13  1    12     B:D       D     B:D       B
14  1    13     B:D     B:D       D     C:D
15  1    14       B       C       A       B
16  1    15     B:D     B:D       D       D
17  1    16       D       D       D       A
18  1    17     B:D       D       C       C
19  1    18       A     B:D       C       A
20  1    19     B:D       D       C       D
21  1    20       C       B       B       C</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dads</span> <span class="op">&lt;-</span> <span class="va">adults</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span></span>
<span><span class="va">mom</span> <span class="op">&lt;-</span> <span class="va">adults</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">off</span> <span class="op">&lt;-</span> <span class="va">offs</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="kw">for</span><span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dads</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dad</span> <span class="op">&lt;-</span> <span class="va">dads</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span></span>
<span>  <span class="cn">T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gstudio/man/transition_probability.html">transition_probability</a></span><span class="op">(</span><span class="va">off</span>,<span class="va">mom</span>,<span class="va">dad</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span> <span class="cn">T</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Father"</span>,<span class="va">i</span>,<span class="st">"may be the real father (T ="</span>,<span class="cn">T</span>,<span class="st">")\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Father 24 may be the real father (T = 0.00390625 )
Father 30 may be the real father (T = 0.00390625 )
Father 44 may be the real father (T = 0.0078125 )
Father 77 may be the real father (T = 0.015625 )
Father 82 may be the real father (T = 0.0078125 )
Father 86 may be the real father (T = 0.0078125 )
Father 95 may be the real father (T = 0.00390625 )</code></pre>
</div>
</div>
</section><section id="fractional-paternity" class="level2" data-number="15.4"><h2 data-number="15.4" class="anchored" data-anchor-id="fractional-paternity">
<span class="header-section-number">15.4</span> Fractional Paternity</h2>
<p>In cases where we have more than one putative father, we may want to get an idea of the relative strength of our inferences by comparing the likelihood ratios for all dads.</p>
<ol type="1">
<li>We may use arbitrary cut-offs, or<br>
</li>
<li>We may use all non-excluded dads, but weighted by their fractional contributions</li>
</ol>
<p>Conditional Probability</p>
<p><strong>Problem:</strong> We have several putative fathers (<span class="math inline">\(MP_i, MP_j, MP_k, ... , MP_m\)</span>) have been found to have non-zero likelihoods of paternity.</p>
<p><span class="math inline">\(\;\)</span></p>
<p><strong>Question:</strong> What is the relative likelihood of paternity given these putative fathers?</p>
<p>Conditional Probability</p>
<p>Conditional probability determines the likelihood of an event (paternal likelihood) <font class="alert">given</font> that some other event has already happened (not excluded as a potential father).</p>
<p>[ P(MP=j^*|FP=i,O=k) = ]</p>
<p>If we can assume that <span class="math inline">\(P(MP=j|FP=i) = c\)</span> (e.g., the frequencies of the female and male parents are constant with respect to the individual offspring being considered) then,</p>
<p>[ P(MP=j^*|FP=i,O=k) = ]</p>
<p>Fractional Paternity</p>
<p>Some things to consider when using fractional analyses for paternity.</p>
<ol type="1">
<li>Not usually used in human studies.<br>
</li>
<li>Can be considered a <em>prior probability of paternity</em>.<br>
</li>
<li>Can include ecological, spatial, evolutionary components such as differential attractiveness, pollen fertility, output, etc.</li>
<li>Possible tautology</li>
</ol>
<p>Every potential father is assigned paternity, the fraction of <span class="math inline">\(X_{ik}\)</span> on a particular <span class="math inline">\(MP_j\)</span> is proportional to the likelihood ratio.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">frac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gstudio/man/paternity.html">paternity</a></span><span class="op">(</span> <span class="va">offs</span>, <span class="va">mom</span>, <span class="va">dads</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">frac</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     MomID       OffID          DadID            Fij         
 Min.   :1   Min.   : 1.0   Min.   : 2.00   Min.   :0.01639  
 1st Qu.:1   1st Qu.: 7.0   1st Qu.:31.00   1st Qu.:0.05882  
 Median :1   Median :10.0   Median :62.00   Median :0.08696  
 Mean   :1   Mean   :10.4   Mean   :55.79   Mean   :0.12346  
 3rd Qu.:1   3rd Qu.:15.0   3rd Qu.:81.00   3rd Qu.:0.16000  
 Max.   :1   Max.   :20.0   Max.   :99.00   Max.   :0.80000  </code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">frac</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   MomID OffID DadID        Fij
1      1     1    78 0.30769231
2      1     1    45 0.15384615
3      1     1    83 0.15384615
4      1     1    87 0.15384615
5      1     1    25 0.07692308
6      1     1    31 0.07692308
7      1     1    96 0.07692308
8      1     2    11 0.33333333
9      1     2    93 0.33333333
10     1     2    31 0.08333333</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">frac</span><span class="op">$</span><span class="va">OffID</span><span class="op">)</span></span>
<span><span class="va">t</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 
 7  6  5  3 10  7 22  9  9  5  4 11 18  4 10  5  5 12  8  2 </code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">N_pexcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dads</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">excl_multilocus</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>,mu <span class="op">=</span> <span class="va">N_pexcl</span><span class="op">)</span></span>
<span><span class="va">fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  as.numeric(t)
t = 1.896, df = 19, p-value = 0.07327
alternative hypothesis: true mean is not equal to 6.000798
95 percent confidence interval:
  5.782701 10.417299
sample estimates:
mean of x 
      8.1 </code></pre>
</div>
</div>
<p>Maternity Analysis</p>
<p>Putative father identified by mother unknown.</p>
<p>[ _i = \ = ]</p>
<p>where <span class="math inline">\(P(\gamma)\)</span> is the frequency of the offspring genotype in the population. All other things are the same.</p>
<p>Cryptic Gene Flow</p>
<p>Consider the case where:</p>
<ol type="1">
<li>You have identified a set of offspring collected from mothers.</li>
<li>Identified a set of fathers that are probabilistically sires of the offspring.</li>
</ol></section><section id="dispersal-kernels" class="level2" data-number="15.5"><h2 data-number="15.5" class="anchored" data-anchor-id="dispersal-kernels">
<span class="header-section-number">15.5</span> Dispersal Kernels</h2>
<p>Estimating the Disperal Distribution</p>
<p>Once a collection of paternity estimates have been determined, you can use them to estimate a <em>dispersal kernel</em>, describing the probability of paternity as a function of distance from the maternal individual.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> Distance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">rchisq</a></span><span class="op">(</span><span class="fl">10000</span>,df <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Distance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#99d8c9"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Physical Distance"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Probability of Paternity"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="parentage_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Dispersal Kernels | Distributions</p>
<p>The <font class="alert">form</font> of the distribution is critical for estimation. It determines:</p>
<blockquote class="blockquote">
<ol type="1">
<li>The shape of the distribution<br>
</li>
<li>The variance of the distribution</li>
<li>Quantitative estimates and hypotheses you get from the data</li>
</ol>
</blockquote>
<p>Example Kernel Distribution Families</p>
<p><em>Normal Family</em></p>
<p>[ p(a|x,y) = exp]</p>
<p>where <span class="math inline">\(r = \sqrt{ x^2 + y^2}\)</span> and <span class="math inline">\(a = \sigma \sqrt{2}\)</span>.</p>
<p><span class="math inline">\(\;\)</span></p>
<p>This produces a <em>thin tailed</em> distribution.</p>
<p>Example Kernel Distribution Families</p>
<p><em>Exponential Family</em></p>
<p>[ p(a,b|x,y) = exp]</p>
<p>where <span class="math inline">\(\Gamma(a,b)\)</span> is the gamma function and <span class="math inline">\(b\)</span> is a ‘shape’ parameter.</p>
<ol type="1">
<li>When <span class="math inline">\(b=1\)</span> This is the exponential distribution.<br>
</li>
<li>When <span class="math inline">\(b=2\)</span> this is the normal function.<br>
</li>
<li>When <span class="math inline">\(b&lt;1\)</span> this is a fat-tailed distribution.</li>
</ol>
<p>Example Kernel Distribution Families</p>
<p>Other distributions you may run across include:</p>
<ol type="1">
<li>The Geometric distribution,<br>
</li>
<li>The Weibull family of distributions,<br>
</li>
<li>The 2Dt family of distributions.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> Distribution<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Normal"</span>,<span class="st">"Exponential"</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">10000</span><span class="op">)</span><span class="op">)</span>, Value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">r1</span>,<span class="va">r2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Value</span>,fill<span class="op">=</span><span class="va">Distribution</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="parentage_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Concerns with kernel estimation</p>
<p>The following are some assumptions that are inherent in the use of dispersal kernels for estimating connectivity.</p>
<ol type="1">
<li>All functions are continuous,</li>
<li>All functions assume isotropy in dispersal,<br>
</li>
<li>All functions explicitly assume homogeneity of the dispersal matrix.</li>
</ol>
<p>Skills</p>
<p>In this lecture we covered some rather simple parent/offspring relationships and how we can analyze them. Specifically, you should be comfortable with:</p>
<ol type="1">
<li>Understanding the qualities of loci that make for more powerful parentage analyses.<br>
</li>
<li>Be able to estimate single and multilocus exclusion probabilities and understand what they mean.<br>
</li>
<li>Estimate likelihood ratios for paternity given Mother, Offspring, and Putative Male Parent.<br>
</li>
<li>Use fractional paternity and understand conditional probability and how it applies to parentage.</li>
<li>Understand dispersal kernel estimation.</li>
</ol>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./pedigrees.html" class="pagination-link" aria-label="Pedigrees">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Pedigrees</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./part_subdivided_populations.html" class="pagination-link" aria-label="(PART) Subdivided Populations">
        <span class="nav-page-text">(PART) Subdivided Populations</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>